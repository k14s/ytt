#@ load("@ytt:net", "net")

ipv4:
  cidr: #@ net.parse_cidr("192.0.2.1/24")
  cidr_net: #@ net.parse_cidr("192.0.2.1/24").net
  cidr_ip: #@ net.parse_cidr("192.0.2.1/24").ip
  cidr_is_ipv4: #@ net.parse_cidr("192.0.2.1/24").is_ipv4()
  cidr_is_ipv6: #@ net.parse_cidr("192.0.2.1/24").is_ipv6()
  cidr_ip_is_ipv4: #@ net.parse_cidr("192.0.2.1/24").ip.is_ipv4()
  cidr_ip_is_ipv6: #@ net.parse_cidr("192.0.2.1/24").ip.is_ipv6()
ipv6:
  cidr: #@ net.parse_cidr("2001:db8::1/96")
  cidr_net: #@ net.parse_cidr("2001:db8::1/96").net
  cidr_ip: #@ net.parse_cidr("2001:db8::1/96").ip
  cidr_is_ipv4: #@ net.parse_cidr("2001:db8::1/96").is_ipv4()
  cidr_is_ipv6: #@ net.parse_cidr("2001:db8::1/96").is_ipv6()
  cidr_ip_is_ipv4: #@ net.parse_cidr("2001:db8::1/96").ip.is_ipv4()
  cidr_ip_is_ipv6: #@ net.parse_cidr("2001:db8::1/96").ip.is_ipv6()

#@ def get_parse_err(cidr):
#@   _, err = net.parse_cidr(cidr, return_error=True)
#@   return err
#@ end


#@ def get_parse_success(cidr):
#@   cidr, _ = net.parse_cidr(cidr, return_error=True)
#@   return cidr
#@ end

return-error:
  cidr_invalid: #@ get_parse_err("not-a-valid-cidr")
  cidr_not_a_string: #@ get_parse_err(["not-a-string"])
  cidr_success: #@ get_parse_success("192.0.2.1/24")
  cidr_success_net: #@ get_parse_success("192.0.2.1/24").net
  cidr_success_ip: #@ get_parse_success("192.0.2.1/24").ip
  cidr_success_is_ipv4: #@ get_parse_success("192.0.2.1/24").is_ipv4()
  cidr_success_is_ipv6: #@ get_parse_success("192.0.2.1/24").is_ipv6()
  cidr_success_ip_is_ipv4: #@ get_parse_success("192.0.2.1/24").ip.is_ipv4()
  cidr_success_ip_is_ipv6: #@ get_parse_success("192.0.2.1/24").ip.is_ipv6()
  cidr_return_error_false: #@ net.parse_cidr("192.0.2.1/24", return_error=False)


+++

ipv4:
  cidr: 192.0.2.1/24
  cidr_net: 192.0.2.0/24
  cidr_ip: 192.0.2.1
  cidr_is_ipv4: true
  cidr_is_ipv6: false
  cidr_ip_is_ipv4: true
  cidr_ip_is_ipv6: false
ipv6:
  cidr: 2001:db8::1/96
  cidr_net: 2001:db8::/96
  cidr_ip: 2001:db8::1
  cidr_is_ipv4: false
  cidr_is_ipv6: true
  cidr_ip_is_ipv4: false
  cidr_ip_is_ipv6: true
return-error:
  cidr_invalid: 'invalid CIDR address: not-a-valid-cidr'
  cidr_not_a_string: expected a string, but was list
  cidr_success: 192.0.2.1/24
  cidr_success_net: 192.0.2.0/24
  cidr_success_ip: 192.0.2.1
  cidr_success_is_ipv4: true
  cidr_success_is_ipv6: false
  cidr_success_ip_is_ipv4: true
  cidr_success_ip_is_ipv6: false
  cidr_return_error_false: 192.0.2.1/24
